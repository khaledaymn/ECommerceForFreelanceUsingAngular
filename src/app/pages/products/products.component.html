<app-data-table
  [columns]="columns"
  [data]="filteredProducts"
  [loading]="loading"
  [actions]="actions"
  [selectable]="false"
  [viewMode]="viewMode"
  [enableViewToggle]="true"
  searchPlaceholder="البحث في المنتجات..."
  emptyMessage="لا توجد منتجات متاحة"
  [currentPage]="currentPage"
  [totalPages]="totalPages"
  [totalItems]="totalItems"
  [pageSize]="pageSize"
  (searchChange)="onSearch($event)"
  (sortChange)="onSort($event)"
  (rowClick)="onRowClick($event)"
  (actionClick)="onActionClick($event)"
  (viewModeChange)="onViewModeChange($event)"
  (pageChange)="onPageChange($event)"
  (pageSizeChange)="onPageSizeChange($event)"
>
  <div slot="title">
    <h1>إدارة المنتجات</h1>
    <p class="header-subtitle">إدارة وتنظيم جميع المنتجات</p>
  </div>

  <div slot="actions">
    <button class="action-btn export-btn" (click)="openAddModal()">
      <i class="material-icons">add</i>
      <span class="btn-text">إضافة منتج</span>
    </button>
  </div>

  <div slot="filters">
    <div class="filter-group">
      <button class="filter-btn" (click)="toggleFilter('status')">
        الحالة
        <i class="material-icons">expand_more</i>
      </button>
      <div class="filter-dropdown" *ngIf="activeFilter === 'status'">
        <div class="filter-option" (click)="onStatusFilterChange('')">
          <span>جميع الحالات</span>
        </div>
        <div class="filter-option" (click)="onStatusFilterChange('متوفر')">
          <span>متوفر</span>
        </div>
        <div class="filter-option" (click)="onStatusFilterChange('غير متوفر')">
          <span>غير متوفر</span>
        </div>
        <div class="filter-option" (click)="onStatusFilterChange('قريباً')">
          <span>قريباً</span>
        </div>
      </div>
    </div>

    <div class="filter-group">
      <button class="filter-btn" (click)="toggleFilter('category')">
        الفئة
        <i class="material-icons">expand_more</i>
      </button>
      <div class="filter-dropdown" *ngIf="activeFilter === 'category'">
        <div class="filter-option" (click)="onCategoryFilterChange('')">
          <span>جميع الفئات</span>
        </div>
        <div class="filter-option" *ngFor="let category of categories" (click)="onCategoryFilterChange(category.id.toString())">
          <span>{{ category.name }}</span>
        </div>
      </div>
    </div>
  </div>
</app-data-table>

<!-- Product Modal -->
<app-product-modal
  *ngIf="isModalOpen"
  [isOpen]="isModalOpen"
  [product]="editingProduct"
  [categories]="categories"
  (close)="closeModal()"
  (save)="saveProduct($event)"
/>

<!-- Product Details Modal -->
<app-product-details-modal
  *ngIf="isDetailsModalOpen"
  [isOpen]="isDetailsModalOpen"
  [product]="selectedProduct"
  (close)="closeDetailsModal()"
  (edit)="openEditModalFromDetails($event)"
  (delete)="openDeleteConfirmFromDetails($event)"
/>

<!-- Delete Confirmation Dialog -->
<app-confirm-dialog
  *ngIf="deleteConfirm.isOpen"
  [isOpen]="deleteConfirm.isOpen"
  title="تأكيد الحذف"
  message="هل أنت متأكد من حذف هذا المنتج؟ لا يمكن التراجع عن هذا الإجراء."
  confirmText="حذف"
  cancelText="إلغاء"
  (confirm)="confirmDelete()"
  (cancel)="closeDeleteConfirm()"
/>
